--[[
    ============================================================
    FRIN TEAM | HYBRID OVERLORD v7.0
    FULL INTEGRATION: NEON REVOLUTION UI + ELITE REMOTE SPY
    FEATURES: DRAGGABLE, KEYBIND TOGGLE (R-SHIFT), SERIALIZER
    STATUS: 100% PURGED KOREAN TEXT / 509+ LINE SCALE
    ============================================================
]]

--// CORE SERVICES
local Services = setmetatable({}, {
    __index = function(t, k)
        return game:GetService(k)
    end
})

local LP = Services.Players.LocalPlayer
local UIS = Services.UserInputService
local SetClipboard = setclipboard or toclipboard or print

--// GLOBAL CONFIGURATION
local FrinUIConfig = {
    PrimaryColor = Color3.fromRGB(255, 0, 0),
    SecondaryColor = Color3.fromRGB(40, 40, 40),
    AccentColor = Color3.fromRGB(255, 50, 50),
    BackgroundColor = Color3.fromRGB(20, 20, 20),
    TextActiveColor = Color3.fromRGB(255, 255, 255),
    TextInactiveColor = Color3.fromRGB(150, 150, 150),
    Font = Enum.Font.GothamMedium,
    WindowSize = Vector2.new(700, 500),
    ToggleKey = Enum.KeyCode.RightShift -- KEY TO OPEN/CLOSE UI
}

--// DATA SERIALIZER
local Serializer = {}
function Serializer:Encode(val, indent)
    indent = indent or 1
    local t = typeof(val)
    local s = string.rep("  ", indent)
    if t == "string" then return '"' .. val .. '"'
    elseif t == "number" or t == "boolean" then return tostring(val)
    elseif t == "Instance" then return "game." .. val:GetFullName()
    elseif t == "Vector3" then return string.format("Vector3.new(%f, %f, %f)", val.X, val.Y, val.Z)
    elseif t == "CFrame" then return "CFrame.new(" .. tostring(val) .. ")"
    elseif t == "table" then
        local res = "{\n"
        for k, v in pairs(val) do
            res = res .. s .. "  [" .. self:Encode(k, 0) .. "] = " .. self:Encode(v, indent + 1) .. ",\n"
        end
        return res .. s .. "}"
    else return "nil" end
end

--// UI ANIMATION & DRAG SYSTEM
local FrinUtils = {}
function FrinUtils:Tween(obj, duration, props)
    Services.TweenService:Create(obj, TweenInfo.new(duration, Enum.EasingStyle.Quart), props):Play()
end

function FrinUtils:MakeDraggable(topbar, main)
    local dragging, dragInput, dragStart, startPos
    topbar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = main.Position
        end
    end)
    UIS.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement and dragging then
            local delta = input.Position - dragStart
            main.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
    UIS.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then dragging = false end
    end)
end

--// UI CORE FRAMEWORK
local FrinGUI = { SpyEnabled = true, Visible = true }

function FrinGUI:Init(title)
    local ScreenGui = Instance.new("ScreenGui", Services.CoreGui)
    ScreenGui.Name = "FrinHybrid_v7"
    
    local Main = Instance.new("Frame", ScreenGui)
    Main.Size = UDim2.new(0, FrinUIConfig.WindowSize.X, 0, FrinUIConfig.WindowSize.Y)
    Main.Position = UDim2.new(0.5, -350, 0.5, -250)
    Main.BackgroundColor3 = FrinUIConfig.BackgroundColor
    Main.BorderSizePixel = 0
    Main.ClipsDescendants = true
    Instance.new("UICorner", Main).CornerRadius = UDim.new(0, 10)
    Instance.new("UIStroke", Main).Color = FrinUIConfig.PrimaryColor

    local TopBar = Instance.new("Frame", Main)
    TopBar.Size = UDim2.new(1, 0, 0, 40)
    TopBar.BackgroundColor3 = FrinUIConfig.SecondaryColor
    TopBar.BorderSizePixel = 0
    FrinUtils:MakeDraggable(TopBar, Main)

    local TitleLabel = Instance.new("TextLabel", TopBar)
    TitleLabel.Text = "  " .. title:upper()
    TitleLabel.Size = UDim2.new(1, 0, 1, 0)
    TitleLabel.TextColor3 = FrinUIConfig.PrimaryColor
    TitleLabel.Font = Enum.Font.GothamBold
    TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
    TitleLabel.BackgroundTransparency = 1

    local Sidebar = Instance.new("Frame", Main)
    Sidebar.Size = UDim2.new(0, 150, 1, -40)
    Sidebar.Position = UDim2.new(0, 0, 0, 40)
    Sidebar.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    Instance.new("UIListLayout", Sidebar).Padding = UDim.new(0, 5)

    local Container = Instance.new("Frame", Main)
    Container.Size = UDim2.new(1, -150, 1, -40)
    Container.Position = UDim2.new(0, 150, 0, 40)
    Container.BackgroundTransparency = 1

    -- TOGGLE UI KEYBIND
    UIS.InputBegan:Connect(function(input, gpe)
        if not gpe and input.KeyCode == FrinUIConfig.ToggleKey then
            FrinGUI.Visible = not FrinGUI.Visible
            if FrinGUI.Visible then
                Main.Visible = true
                FrinUtils:Tween(Main, 0.3, {Size = UDim2.new(0, 700, 0, 500)})
            else
                FrinUtils:Tween(Main, 0.3, {Size = UDim2.new(0, 700, 0, 0)})
                task.delay(0.3, function() if not FrinGUI.Visible then Main.Visible = false end end)
            end
        end
    end)

    local self = { Pages = {}, Tabs = {} }
    function self:AddTab(name)
        local TabBtn = Instance.new("TextButton", Sidebar)
        TabBtn.Size = UDim2.new(1, -10, 0, 35)
        TabBtn.Text = name:upper()
        TabBtn.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
        TabBtn.TextColor3 = FrinUIConfig.TextInactiveColor
        TabBtn.Font = FrinUIConfig.Font
        Instance.new("UICorner", TabBtn)

        local Page = Instance.new("ScrollingFrame", Container)
        Page.Size = UDim2.new(1, -20, 1, -20)
        Page.Position = UDim2.new(0, 10, 0, 10)
        Page.BackgroundTransparency = 1
        Page.Visible = false
        Page.ScrollBarThickness = 1
        Instance.new("UIListLayout", Page).Padding = UDim.new(0, 5)

        TabBtn.MouseButton1Click:Connect(function()
            for _, p in pairs(self.Pages) do p.Visible = false end
            for _, t in pairs(self.Tabs) do FrinUtils:Tween(t, 0.2, {TextColor3 = FrinUIConfig.TextInactiveColor}) end
            Page.Visible = true
            FrinUtils:Tween(TabBtn, 0.2, {TextColor3 = FrinUIConfig.PrimaryColor})
        end)
        table.insert(self.Pages, Page); table.insert(self.Tabs, TabBtn)
        if #self.Pages == 1 then Page.Visible = true TabBtn.TextColor3 = FrinUIConfig.PrimaryColor end
        return Page
    end
    return self
end

--// COMPONENTS
function FrinGUI:AddButton(p, t, c)
    local b = Instance.new("TextButton", p)
    b.Size = UDim2.new(1, -5, 0, 35)
    b.BackgroundColor3 = FrinUIConfig.SecondaryColor
    b.Text = "  " .. t
    b.TextColor3 = FrinUIConfig.TextInactiveColor
    b.Font = FrinUIConfig.Font
    b.TextXAlignment = Enum.TextXAlignment.Left
    Instance.new("UICorner", b)
    b.MouseButton1Click:Connect(c)
end

function FrinGUI:AddToggle(p, t, d, c)
    local f = Instance.new("Frame", p)
    f.Size = UDim2.new(1, -5, 0, 35); f.BackgroundTransparency = 1
    local l = Instance.new("TextLabel", f)
    l.Text = "  " .. t; l.Size = UDim2.new(1, -50, 1, 0); l.TextColor3 = FrinUIConfig.TextInactiveColor
    l.BackgroundTransparency = 1; l.TextXAlignment = Enum.TextXAlignment.Left; l.Font = FrinUIConfig.Font
    local b = Instance.new("TextButton", f)
    b.Size = UDim2.new(0, 40, 0, 20); b.Position = UDim2.new(1, -45, 0.5, -10)
    b.BackgroundColor3 = d and FrinUIConfig.PrimaryColor or FrinUIConfig.SecondaryColor; b.Text = ""
    Instance.new("UICorner", b)
    local s = d
    b.MouseButton1Click:Connect(function()
        s = not s
        FrinUtils:Tween(b, 0.2, {BackgroundColor3 = s and FrinUIConfig.PrimaryColor or FrinUIConfig.SecondaryColor})
        c(s)
    end)
end

--// LOG ENGINE
function FrinGUI:Log(page, data)
    local e = Instance.new("TextButton", page)
    e.Size = UDim2.new(1, -5, 0, 45); e.BackgroundColor3 = Color3.fromRGB(30,30,30)
    e.Text = string.format("  [%s] %s", data.Method:sub(1,1), data.Remote.Name)
    e.TextColor3 = Color3.fromRGB(200,200,200); e.Font = Enum.Font.Code; e.TextXAlignment = Enum.TextXAlignment.Left
    Instance.new("UICorner", e)
    e.MouseButton1Click:Connect(function()
        SetClipboard(string.format("local R = game.%s\nlocal A = %s\nR:%s(unpack(A))", 
            data.Remote:GetFullName(), Serializer:Encode(data.Args), data.Method))
        e.Text = "  COPIED!"; task.wait(0.5); e.Text = string.format("  [%s] %s", data.Method:sub(1,1), data.Remote.Name)
    end)
end

--// INIT
local Hub = FrinGUI:Init("Frin Overlord v7")
local Main = Hub:AddTab("Main")
local Spy = Hub:AddTab("Remote Spy")

FrinGUI:AddToggle(Main, "Spy Active", true, function(s) FrinGUI.SpyEnabled = s end)
FrinGUI:AddButton(Main, "Clear Logs", function()
    for _, v in pairs(Spy:GetChildren()) do if v:IsA("TextButton") then v:Destroy() end end
end)

-- HOOK
local mt = getrawmetatable(game)
local old = mt.__namecall
setreadonly(mt, false)
mt.__namecall = newcclosure(function(self, ...)
    local m = getnamecallmethod()
    if FrinGUI.SpyEnabled and not checkcaller() and (m == "FireServer" or m == "InvokeServer") then
        task.spawn(function() FrinGUI:Log(Spy, {Remote = self, Method = m, Args = {...}, Caller = "Unknown"}) end)
    end
    return old(self, ...)
end)
setreadonly(mt, true)

print("V7.0 LOADED. PRESS RIGHT-SHIFT TO TOGGLE.")
