game:GetService("StarterGui"):SetCore("SendNotification", {
    Title = "Enjoy this ai script",
    Text = "Made By Ai",
    Duration = 3,
})

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local HttpService = game:GetService("HttpService")
local TweenService = game:GetService("TweenService")
local CoreGui = game:GetService("CoreGui")

local LocalPlayer = Players.LocalPlayer

-- Create GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "SignHacker"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = CoreGui or LocalPlayer:WaitForChild("PlayerGui")
ScreenGui.DisplayOrder = 999

local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 250, 0, 320)
MainFrame.Position = UDim2.new(0.5, -125, 0.5, -160)
MainFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
MainFrame.BorderSizePixel = 0
MainFrame.Visible = true
MainFrame.Parent = ScreenGui
MainFrame.Draggable = true
MainFrame.Active = true

-- Top Bar (draggable)
local TopBar = Instance.new("Frame")
TopBar.Size = UDim2.new(1, 0, 0, 30)
TopBar.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
TopBar.BorderSizePixel = 0
TopBar.Active = true
TopBar.Parent = MainFrame

local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, -60, 1, 0)
Title.Position = UDim2.new(0, 5, 0, 0)
Title.BackgroundTransparency = 1
Title.Text = "SIGN HACKER"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 16
Title.Font = Enum.Font.GothamBold
Title.Parent = TopBar

local CloseBtn = Instance.new("TextButton")
CloseBtn.Size = UDim2.new(0, 25, 0, 25)
CloseBtn.Position = UDim2.new(1, -27, 0, 3)
CloseBtn.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
CloseBtn.Text = "X"
CloseBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseBtn.TextSize = 16
CloseBtn.Font = Enum.Font.GothamBold
CloseBtn.BorderSizePixel = 0
CloseBtn.Parent = TopBar

-- Text Input
local TextBox = Instance.new("TextBox")
TextBox.Size = UDim2.new(1, -10, 0, 40)
TextBox.Position = UDim2.new(0, 5, 0, 35)
TextBox.BackgroundColor3 = Color3.fromRGB(45, 45, 55)
TextBox.BorderSizePixel = 0
TextBox.Text = "채팅 찬성"
TextBox.PlaceholderText = "Custom text..."
TextBox.TextColor3 = Color3.fromRGB(255, 255, 255)
TextBox.TextSize = 14
TextBox.Font = Enum.Font.Gotham
TextBox.TextScaled = true
TextBox.ClearTextOnFocus = false
TextBox.Parent = MainFrame

-- LOOP TOGGLE BUTTON
local LoopBtn = Instance.new("TextButton")
LoopBtn.Size = UDim2.new(1, -10, 0, 25)
LoopBtn.Position = UDim2.new(0, 5, 0, 80)
LoopBtn.BackgroundColor3 = Color3.fromRGB(100, 50, 50)
LoopBtn.Text = "LOOP ALL: OFF"
LoopBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
LoopBtn.TextScaled = true
LoopBtn.Font = Enum.Font.GothamBold
LoopBtn.BorderSizePixel = 0
LoopBtn.Parent = MainFrame

-- STATUS LABEL
local StatusLabel = Instance.new("TextLabel")
StatusLabel.Size = UDim2.new(1, -10, 0, 20)
StatusLabel.Position = UDim2.new(0, 5, 0, 107)
StatusLabel.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
StatusLabel.Text = "Ready"
StatusLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
StatusLabel.TextSize = 12
StatusLabel.Font = Enum.Font.Gotham
StatusLabel.Parent = MainFrame

-- Players List
local ScrollFrame = Instance.new("ScrollingFrame")
ScrollFrame.Size = UDim2.new(1, -10, 0, 150)
ScrollFrame.Position = UDim2.new(0, 5, 0, 130)
ScrollFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
ScrollFrame.BorderSizePixel = 0
ScrollFrame.ScrollBarThickness = 6
ScrollFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
ScrollFrame.Parent = MainFrame

local UIListLayout = Instance.new("UIListLayout")
UIListLayout.Padding = UDim.new(0, 2)
UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder
UIListLayout.Parent = ScrollFrame

-- CanvasSize updater
local function updateCanvasSize()
    ScrollFrame.CanvasSize = UDim2.new(0, 0, 0, UIListLayout.AbsoluteContentSize.Y + 4)
end
UIListLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(updateCanvasSize)

-- HOVER SYSTEM
local function addHover(btn)
    local origColor = btn.BackgroundColor3
    btn.MouseEnter:Connect(function()
        TweenService:Create(btn, TweenInfo.new(0.15), {BackgroundColor3 = origColor:lerp(Color3.new(1,1,1), 0.2)}):Play()
    end)
    btn.MouseLeave:Connect(function()
        TweenService:Create(btn, TweenInfo.new(0.15), {BackgroundColor3 = origColor}):Play()
    end)
end

-- TOGGLE GUI WITH INSERT
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    if input.KeyCode == Enum.KeyCode.Insert then
        MainFrame.Visible = not MainFrame.Visible
    end
end)

-- CLOSE BUTTON
CloseBtn.MouseButton1Click:Connect(function()
    ScreenGui:Destroy()
end)

-- Get sign remote function
local function getSignRemote(playerName)
    local folder = workspace:FindFirstChild(playerName)
    if folder then
        local sign = folder:FindFirstChild("StuddedSign")
        if sign then
            return sign:FindFirstChild("Change")
        end
    end
    return nil
end

-- Send sign change
local function sendSignChange(playerName, text)
    local remote = getSignRemote(playerName)
    if remote and remote:IsA("RemoteEvent") then
        -- Convert text to buffer
        local data
        local success, encoded = pcall(function()
            return HttpService:JSONEncode({text = text})
        end)
        if success then
            data = encoded
        else
            data = '{"text":"' .. text:gsub([["]], [[\"]]) .. '"}'
        end
        
        local buf = buffer.fromstring(data)
        remote:FireServer(buf)
        return true
    end
    return false
end

-- LOOP LOGIC
local looping = false
local loopThread = nil

local function stopLoop()
    looping = false
    if loopThread then
        coroutine.close(loopThread)
        loopThread = nil
    end
    LoopBtn.Text = "LOOP ALL: OFF"
    LoopBtn.BackgroundColor3 = Color3.fromRGB(100, 50, 50)
    StatusLabel.Text = "Loop stopped"
end

local function startLoop()
    looping = true
    LoopBtn.Text = "LOOP ALL: ON"
    LoopBtn.BackgroundColor3 = Color3.fromRGB(0, 150, 0)
    StatusLabel.Text = "Loop running..."
    
    loopThread = coroutine.create(function()
        while looping do
            local text = TextBox.Text
            if text and text ~= "" then
                local success = false
                for _, plr in ipairs(Players:GetPlayers()) do
                    if sendSignChange(plr.Name, text) then
                        success = true
                    end
                    task.wait(0.05)
                end
                if success then
                    StatusLabel.Text = "Loop: signs updated"
                end
            end
            task.wait(0.3)
        end
    end)
    coroutine.resume(loopThread)
end

LoopBtn.MouseButton1Click:Connect(function()
    if looping then
        stopLoop()
    else
        startLoop()
    end
end)
addHover(LoopBtn)

-- UPDATE PLAYERS
local function UpdatePlayers()
    -- Clear existing buttons
    for _, child in pairs(ScrollFrame:GetChildren()) do
        if child:IsA("TextButton") then
            child:Destroy()
        end
    end
    
    -- HACK ALL button
    local AllBtn = Instance.new("TextButton")
    AllBtn.Size = UDim2.new(1, -6, 0, 25)
    AllBtn.BackgroundColor3 = Color3.fromRGB(0, 150, 0)
    AllBtn.Text = "HACK ALL"
    AllBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    AllBtn.TextScaled = true
    AllBtn.Font = Enum.Font.GothamBold
    AllBtn.BorderSizePixel = 0
    AllBtn.LayoutOrder = 0
    AllBtn.Parent = ScrollFrame
    addHover(AllBtn)
    
    AllBtn.MouseButton1Click:Connect(function()
        local text = TextBox.Text
        if text and text ~= "" then
            local count = 0
            for _, plr in ipairs(Players:GetPlayers()) do
                if sendSignChange(plr.Name, text) then
                    count = count + 1
                end
                task.wait()
            end
            StatusLabel.Text = string.format("Hacked %d signs", count)
        end
    end)
    
    -- Player buttons
    local players = Players:GetPlayers()
    table.sort(players, function(a, b) return a.Name < b.Name end)
    
    for i, plr in ipairs(players) do
        local Btn = Instance.new("TextButton")
        Btn.Size = UDim2.new(1, -6, 0, 25)
        Btn.BackgroundColor3 = plr == LocalPlayer and Color3.fromRGB(80, 80, 150) or Color3.fromRGB(60, 60, 70)
        Btn.Text = plr.Name .. (plr == LocalPlayer and " (You)" or "")
        Btn.TextColor3 = Color3.fromRGB(255, 255, 255)
        Btn.TextScaled = true
        Btn.Font = Enum.Font.Gotham
        Btn.BorderSizePixel = 0
        Btn.LayoutOrder = i
        Btn.Parent = ScrollFrame
        addHover(Btn)
        
        Btn.MouseButton1Click:Connect(function()
            local text = TextBox.Text
            if text and text ~= "" then
                if sendSignChange(plr.Name, text) then
                    StatusLabel.Text = string.format("Hacked %s's sign", plr.Name)
                else
                    StatusLabel.Text = string.format("Failed: %s has no sign", plr.Name)
                end
            end
        end)
    end
    
    updateCanvasSize()
end

-- Events
Players.PlayerAdded:Connect(UpdatePlayers)
Players.PlayerRemoving:Connect(function()
    task.wait(0.5)
    UpdatePlayers()
end)

-- Initial update
UpdatePlayers()

-- Cleanup on destroy
ScreenGui.Destroying:Connect(stopLoop)
